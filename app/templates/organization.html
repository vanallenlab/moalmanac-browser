{% extends 'base.html' %}

{% block title %}
{{ organization.id }} | Molecular Oncology Almanac
{% endblock %}

{% block content %}
  <br>
  <h2 class="title">{{ organization.name }}</h2>
  <p>{{ organization.description }}</p>

  <h4 class="subtitle">Documents</h4>
  Documents published by the {{ organization.name }}, containing at least one indication involving a biomarker.
  <br><br>

  <table id="documents-table-result" class="table table-striped table-hover table-sm small w-100 dataTable">
    <thead>
      <tr>
        <th style="width: 70%">Name</th>
        <th style="width: 15%">Indications</th>
        <th style="width: 15%">Statements</th>
      </tr>
    </thead>
    <tbody>
      {% for document in documents %}
        <tr>
          <td><a href="{{ url_for('main.documents', document_id=document.id) }}">{{ document.name }}</a></td>
          <td>{{ document.indications_count }}</td>
          <td>{{ document.statements_count }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <br><br>

  <h4 class="subtitle">Regulatory approvals</h4>
  Approved indications from the {{ organization.name }} for cancer drugs containing at least one biomarker.
  <br><br>

  <table id="indications-table-result" class="table table-striped table-hover table-sm small w-100 dataTable">
    <thead>
      <tr>
        <th style="width: 25%">Document</th>
        <th style="width: 65%">Indication</th>
        <th style="width: 10%">Statements</th>
      </tr>
    </thead>
    <tbody>
      {% for indication in indications %}
        <tr data-organization="{{ indication.document.organization.name }}">
          <td><a href="{{ url_for('main.documents', document_id=indication.document.id) }}">{{ indication.document.name }}</a></td>
          <td>{{ indication.indication }}</td>
          <td>{{ indication.statements_count }}</td>
        </tr>
        {% endfor %}
      </tbody>
  </table>
  <br><br>

  <h4 class="subtitle">Therapeutic response</h4>
  Precision oncology relationships for therapeutic response derived from {{ organization.name }}'s regulatory approvals.
  <br><br>
  <table id="statements-table-result" class="table table-striped table-hover table-sm small w-100 dataTable">
    <thead>
      <tr>
        <!--<th style="width: 10%>Implication</th>-->
        <th style="width: 10%">Type</th>
        <th style="width: 25%">Biomarker(s)</th>
        <th style="width: 25%">Cancer type</th>
        <th style="width: 25%">Therapy(ies)</th>
        <th style="width: 5%"></th>
      </tr>
    </thead>
    <tbody>
      {% for statement in statements %}
        <tr>
          <td>{{ statement.proposition.predicate }} ({{ statement.direction }})</td>
          <td>{{ statement.proposition['biomarkers'] | map(attribute='name') | join(', ') }}</td>
          <td>{{ statement.proposition['cancer_type']['name'] }}</td>
          <td>
            {% for therapy in statement.proposition['therapies'] %}
              <a href="{{ url_for('main.therapies', therapy_name=therapy.name) }}">{{ therapy.name }}</a>{% if not loop.last %},{% endif %}
            {% endfor %}
          </td>
          <td>
            <a href="{{ url_for('main.index') }}" class="btn btn-sm" title="More information" data-bs-toggle="tooltip">
              <i class="bi bi-info-circle" aria-hidden="true"></i>
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
  </table>

  <br><br>

{% endblock %}